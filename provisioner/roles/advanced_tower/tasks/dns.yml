---
- name: print all hostvars
  debug:
    var: "{{ item }}"
  with_items:
  - s3_state
  - workshop_dns_zone

# - name: add DNS record for current node
#   route53:
#     state: "{{ s3_state }}"
#     zone: "{{workshop_dns_zone}}"
#     record: "{{ ansible_nodename }}.{{ec2_name_prefix|lower}}.{{workshop_dns_zone}}"
#     type: A
#     overwrite: true
#     value: "{{ ansible_host }}"
#   delegate_to: localhost

# use this task to check authentication
- name: find ami for node
  ec2_ami_facts:
    region: "{{ ec2_region }}"
    owners: "{{ ec2_info[rhel].owners }}"
    filters:
      name: "{{ ec2_info[rhel].filter }}"
      architecture: "{{ ec2_info[rhel].architecture }}"
  delegate_to: localhost
  delegate_facts: true

- name: add DNS record for current node
  route53:
    state: present
    zone: workshop.jung-christian.de
    record: playbook.workshop.jung-christian.de
    type: A
    overwrite: true
    value: 1.2.3.4
  delegate_to: localhost
  delegate_facts: true
